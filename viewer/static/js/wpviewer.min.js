function change_content(b){wp_content.setValue(b);wp_content.selection.selectFileStart()}
function load_file_data(b){var a=JSON.parse(b.responseText);if("error"==a.status)(b=a.message)?$("#file-content-box").html("<span>"+b+"</span>"):$("#file-content-box").html("<span>Sorry, an unknown error occurred.</span>");else if(a.file_content){if(change_content(a.file_content),b=wp_modelist.getModeForPath(a.static_path),wp_content.getSession().setMode(b.mode),$("#file-content").fadeIn(),null!==a.project_alias&&null!==a.project_name?($("#project-title-name").html(a.project_name),$("#project-link").click(function(){wptools.navigateto("/projects/"+
a.project_alias)}),a.project_alias&&$("#project-info").fadeIn()):null!==a.misc_alias&&null!==a.misc_name&&($("#project-title-name").html(a.misc_name),$("#project-link").click(function(){wptools.navigateto("/misc/"+a.misc_alias)}),a.misc_alias&&$("#project-info").fadeIn()),a.file_short&&a.static_path&&($("#viewer-filename").html(a.file_short),$("#file-link").click(function(){wptools.navigateto("/dl/"+a.static_path)}),a.file_short&&$("#file-info").fadeIn()),b=a.menu_items){var c=b.length;0===$(".vertical-menu-item").length&&
0<c&&($.each(b,function(){$("#file-menu-items").append("<a href='javascript: view_file(\""+this[0].replace(/[ ]/g,"/")+"\");'><li class='vertical-menu-item'><span class='vertical-menu-text'>"+this[1]+"</span></li></a>")}),$("#file-menu").fadeIn())}}else $("#file-content-box").html("<span>Sorry, no content in this file...</span>")}
function setup_ace(b){wp_content=ace.edit("file-content");wp_content.setTheme("ace/theme/solarized_dark");wp_content.setHighlightActiveLine(!0);wp_content.setAnimatedScroll(!0);wp_content.setFontSize(14);wp_content.setReadOnly(!0);wp_modelist=ace.require("ace/ext/modelist");b&&(b=wp_modelist.getModeForPath(b))&&wp_content.getSession().setMode(b.mode)}
function update_loading_msg(b){$("#loading-msg").html(b);wptools.center_element("#floater");b=$("#floater");var a=$(this).scrollTop();b.css({top:a+200+"px"});$("#floater").fadeIn()}
function view_file(b){var a={file:b};update_loading_msg("<span>Loading file: "+b+"...</span>");$("#file-info").fadeOut();$.ajax({type:"post",contentType:"application/json",url:"/view/file/",data:JSON.stringify(a),dataType:"json",failure:function(a,b,d){console.log("failure: "+b)},complete:function(a,b){"error"==b?($("#file-content-box").html("<span class='B'>Sorry, either that file doesn't exist, or there was an error processing it.</span>"),console.log("wp-error response: "+a.responseText)):load_file_data(a);
$("#floater").fadeOut()},status:{404:function(){console.log("PAGE NOT FOUND!")},500:function(){console.log("A major error occurred.")}}})};
