var wppaste={build_lang_menu:function(){var a=wp_modelist.modes.length,b,e,c=document.createDocumentFragment();b=document.createElement("option");$(b).attr({val:""});$(b).text("[none]");$(c).append(b);for(var d=0;d<a;d++)b=wp_modelist.modes[d],e=document.createElement("option"),$(e).attr({val:b.mode}),$(e).text(b.name),$(c).append(e);$("#langselect").append(c)},get_mode_byname:function(a){return(a=wp_modelist.modesByName[a])?a:""},get_paste_author:function(){return $("#paste-author-entry").val()},
get_paste_title:function(){return $("#paste-title-entry").val()},get_selected_lang:function(){var a=document.getElementById("langselect");return $(a.options[a.selectedIndex]).text()},get_selected_mode:function(){var a=document.getElementById("langselect");return $(a.options[a.selectedIndex]).attr("val")},load_paste_settings:function(a){var b=$.cookie("pastesettings"),e="",c="python";a=a||{nolangset:!1};b&&(b=JSON.parse(b),e=b.author||"",c=b.lang||"python");a.nolangset||wppaste.set_selected_mode(c);
$("#paste-author-entry").val(e)},on_mode_change:function(){var a=wppaste.get_selected_mode();wp_content.getSession().setMode(a)},set_selected_mode:function(a){for(var b=document.getElementById("langselect"),e=b.options.length,c=0;c<e;c++)if(a==$(b.options[c]).text())return b.selectedIndex=c,wppaste.on_mode_change(),!0;b.selectedIndex=0;wppaste.on_mode_change();return!1},submit_paste:function(a){a=a?a:{};a.author=wppaste.get_paste_author();a.content=wp_content.getValue();a.title=wppaste.get_paste_title();
a.language=wppaste.get_selected_lang();var b=$("#replyto-id").attr("value");a.replyto=b;if(wptools.is_emptystr(a.content))return show_error_msg('<span class="warning-msg">Paste must have some content.</span>'),!1;a.title||(a.title="Untitled");update_loading_msg("<span>Submitting paste...</span>");$.ajax({type:"post",contentType:"application/json",url:"/apps/paste/submit",data:JSON.stringify(a),dataType:"json",failure:function(a,b,d){console.log("failure: "+b)},complete:function(a,b){if("error"==b)console.log("wp-error response: "+
a.responseText);else{var d=JSON.parse(a.responseText);d.status&&"error"===d.status?(show_error_msg('<span class="warning-msg">'+d.message+"</span>"),console.log("error: "+d.message)):(wppaste.submit_success(d),$("#floater").fadeOut())}},status:{404:function(){console.log("PAGE NOT FOUND!")},500:function(){console.log("A major error occurred.")}}})},submit_success:function(a){if(a.url){var b=JSON.stringify({lang:wppaste.get_selected_lang(),author:wppaste.get_paste_author()});$.cookie("pastesettings",
b,{expires:365,path:"/"});wptools.navigateto(a.url)}}};function setup_ace(a){wp_content=ace.edit("paste-content");wp_content.setTheme("ace/theme/solarized_dark");wp_content.setHighlightActiveLine(!0);wp_content.setAnimatedScroll(!0);wp_content.setFontSize(14);wp_content.getSession().setUseSoftTabs(!0);a&&wp_content.setReadOnly(!0);wp_modelist=ace.require("ace/ext/modelist")}
function update_loading_msg(a){$("#floater-msg").html(a);wptools.center_element("#floater");$("#floater");$(this).scrollTop();$("#floater").fadeIn()}function show_error_msg(a){$("#floater-msg").html(a);wptools.center_element("#floater");$("#floater");$(this).scrollTop();$("#floater").fadeIn();setTimeout(function(){kill_message()},3E3)}function kill_message(){$("#floater").fadeOut()};
